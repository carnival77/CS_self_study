# 식별과 비식별

---
- [식별과 비식별](#식별과-비식별)
    - [식별 관계](#식별-관계)
    - [비식별 관계](#비식별-관계)
    - [각각의 전략으로 테이블을 구성할 경우](#각각의-전략으로-테이블을-구성할-경우)
    - [장단점](#장단점)
---

RDBMS의 테이블을 생성하고, 각 테이블마다 관계를 설정해 줄 때 일반적으로 외래 키를 사용하곤 합니다. 외래 키를 통해 다른 테이블과 같은 키를 공유하고 이를 이용하여 조인하여 관계를 이용하는 방식을 사용합니다. 외래 키를 사용하여 테이블 간 관계를 정립해 줄 때 사용하는 전략은 크게 식별 관계, 비식별 관계 전략이 있습니다.

### 식별 관계

![img](https://blog.kakaocdn.net/dn/YioAe/btqFPriMerk/FrSpo08ZHl2KpDTg2ReIxK/img.png)

식별 관계란, **부모 테이블의 기본키 또는 유니크 키를 자식 테이블이 자신의 기본키로 사용**하는 관계입니다. 부모 테이블의 키가 자신의 기본키에 포함되기 때문에 반드시 부모 테이블에 데이터가 존재해야 자식 테이블에 데이터를 입력할 수 있습니다. 즉, 부모 데이터가 없다면 자식 데이터는 생길 수 없습니다.

식별관계는 ERD상에서 실선으로 표시합니다. 자식 테이블에 데이터가 존재한다면 부모 데이터가 반드시 존재하는 상태가 됩니다. 바퀴는 자동차 테이블에 데이터가 존재해야 생성할 수 있습니다. 즉, 부모 테이블에 자식 테이블이 종속됩니다.

### 비식별 관계

![img](https://blog.kakaocdn.net/dn/cFZ1cV/btqFOWQQR80/5bf3sjjPznGDUz0kSIpQck/img.png)

비 식별 관계란 **부모 테이블의 기본키 또는 유니크 키를 자신의 기본키로 사용하지 않고, 외래 키로 사용하는 관계**입니다. 자식 데이터는 부모 데이터가 없어도 독립적으로 생성될 수 있습니다. 부모와의 의존성을 줄일 수 있기 때문에 조금 더 자유로운 데이터 생성과 수정이 가능합니다.

### 각각의 전략으로 테이블을 구성할 경우

식별관계의 경우 자식 데이터를 넣기 전, 부모 테이블에 필수적으로 데이터가 존재해야 합니다. 또한 기본키를 여러 복합 자연 키로 처리하기 때문에 입력할 수 있는 데이터에 제한을 걸 수 있습니다.

예를 들어, 4륜 자동차를 생성하려고 한다면 식별 관계에서는 다음과 같이 데이터를 넣을 수 있습니다.

우선 만들고자 하는 자동차의 데이터를 입력합니다.

| 자동차_아이디(PK) | 이름  | 가격  |
| ----------------- | ----- | ----- |
| 12345             | 4륜차 | 10000 |

바퀴의 데이터를 다음과 같이 입력할 수 있겠네요. 바퀴 데이터는 아래 3개의 키가 묶여 복합 기본키를 가집니다.

| 자동차_아이디(PK, FK) | 바퀴_위치(PK) |
| --------------------- | ------------- |
| 12345                 | "FRONT_LEFT"  |
| 12345                 | "FRONT_RIGHT" |
| 12345                 | "BACK_LEFT"   |
| 12345                 | "BACK_RIGHT"  |

개발자가 왼쪽 앞바퀴를 추가적으로 입력하려고 하면 어떻게 될까요? PK는 중복해서 존재할 수 없습니다. 그렇기 때문에 개발자의 실수로 데이터를 DB에 입력하려 해도 데이터 입력 자체가 불가능해집니다. 즉 데이터 정합성을 DB에서도 체크할 수 있게 됩니다.

식별 관계는 요구사항이 변하지 않을 때 강력한 데이터 정합성을 보장할 수 있습니다. 반대로, 요구사항이 변경되었을 때는 개발자의 발목을 끝없이 잡을 수 있습니다. 예를 들어, 말도 안 되는 일이지만 앞쪽, 왼쪽 바퀴를 1개가 아닌 3개 이상을 허용해야 한다고 요구사항이 변경된다면 어떻게 될까요?

<iframe id="aswift_2" name="aswift_2" browsingtopics="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="616" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-5468461097802967&amp;output=html&amp;h=280&amp;adk=508362192&amp;adf=851995522&amp;pi=t.aa~a.1854850302~i.56~rp.4&amp;w=616&amp;abgtt=9&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1731638923&amp;num_ads=1&amp;rafmt=1&amp;armr=3&amp;sem=mc&amp;pwprc=3123654457&amp;ad_type=text_image&amp;format=616x280&amp;url=https%3A%2F%2Fdeveric.tistory.com%2F108&amp;host=ca-host-pub-9691043933427338&amp;fwr=0&amp;pra=3&amp;rh=154&amp;rw=615&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;fa=27&amp;uach=WyJXaW5kb3dzIiwiMTUuMC4wIiwieDg2IiwiIiwiMTMwLjAuNjcyMy4xMTciLG51bGwsMCxudWxsLCI2NCIsW1siQ2hyb21pdW0iLCIxMzAuMC42NzIzLjExNyJdLFsiR29vZ2xlIENocm9tZSIsIjEzMC4wLjY3MjMuMTE3Il0sWyJOb3Q_QV9CcmFuZCIsIjk5LjAuMC4wIl1dLDBd&amp;dt=1731638923512&amp;bpp=1&amp;bdt=931&amp;idt=1&amp;shv=r20241112&amp;mjsv=m202411130101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D9b4e073ea969f0e9%3AT%3D1724588032%3ART%3D1731638784%3AS%3DALNI_MZbGUJdTVuQ_cwkD_sD1TLtfNZSDQ&amp;gpic=UID%3D00000ed70bc807b2%3AT%3D1724588032%3ART%3D1731638784%3AS%3DALNI_MZjuRDIc36yH7zEjvCWCjXFFMbqKg&amp;eo_id_str=ID%3Dd2c4629a9314b12e%3AT%3D1722396554%3ART%3D1731638784%3AS%3DAA-AfjZqfLEuBsv-8gPE9t8kov-h&amp;prev_fmts=0x0&amp;nras=2&amp;correlator=6594978291182&amp;frm=20&amp;pv=1&amp;u_tz=540&amp;u_his=3&amp;u_h=864&amp;u_w=1536&amp;u_ah=816&amp;u_aw=1536&amp;u_cd=24&amp;u_sd=1.25&amp;dmc=8&amp;adx=20&amp;ady=2568&amp;biw=938&amp;bih=695&amp;scr_x=0&amp;scr_y=400&amp;eid=95344187%2C31088996%2C95335247%2C31088249%2C31088457%2C95345966&amp;oid=2&amp;pvsid=1268706653023439&amp;tmod=518816090&amp;uas=0&amp;nvt=3&amp;fc=1408&amp;brdim=581%2C0%2C581%2C0%2C1536%2C0%2C970%2C823%2C955%2C695&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=128&amp;bc=31&amp;bz=1.02&amp;td=1&amp;tdf=2&amp;psd=W251bGwsbnVsbCxudWxsLDNd&amp;nt=1&amp;ifi=3&amp;uci=a!3&amp;btvi=1&amp;fsb=1&amp;dtd=11" data-google-container-id="a!3" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CL2y_dap3YkDFfat6QUd_lss9g" data-load-complete="true" style="margin: 0px auto; max-width: 100%; left: 0px; top: 0px; border: 0px; width: 616px; height: 280px;"></iframe>

이미 FRONT_LEFT 위치에는 데이터가 입력되어있습니다. 이곳에 데이터를 넣기 위해서는 바퀴 위치 공통 코드를 변경하거나 테이블의 데이터와 구조를 모두 변경해야 하는 불상사가 발생합니다. 데이터 정합성을 지키기 위해 진행한 식별 관계는 유동적인 요구사항을 수용하기 어렵게 만들기도 합니다.

 

그렇기 때문에 테이블 설계 시 비식별 관계로 테이블을 설계하는 것을 권장합니다. 비 식별 관계로 테이블을 설계한다면 아래와 같이 데이터를 입력할 수 있습니다.

 

| 바퀴_아이디 (PK) | 자동차_아이디 (FK) | 바퀴_위치     |
| ---------------- | ------------------ | ------------- |
| 11111            | 12345              | "FRONT_LEFT"  |
| 11112            | 12345              | "FRONT_LEFT"  |
| 11113            | 12345              | "FRONT_LEFT"  |
| 11114            | 12345              | "FRONT_RIGHT" |

비식별 관계에서는 자동차를 만들기 전, 바퀴 데이터를 먼저 입력해야 한다고 요구사항이 변경되었을 때도 수용이 가능합니다. 자신만이 가지고 있는 인조 키인 "바퀴_아이디"를 가지고 있기 때문에 부모 테이블과 종속적인 관계없이 독립적으로 존재할 수 있기 때문입니다. 

| 바퀴_아이디 | 자동차_아이디 (FK) | 바퀴_위치 |
| ----------- | ------------------ | --------- |
| 11115       | null               | null      |
| 11116       | null               | null      |

이후 바퀴가 달릴 자동차가 정해진다면 데이터를 업데이트시키기만 하면 됩니다.

### 장단점

**식별 관계**

- 장점

  - 데이터의 정합성 유지를 DB에서 한번 더 할 수 있다

  - 자식 테이블에 데이터가 존재한다면 부모 데이터도 반드시 존재한다고 보장할 수 있다


- 단점
  - 요구사항이 변경되었을 경우 구조 변경이 어렵다


**비식별 관계**

- 장점
  - 변경되는 요구사항을 유동적으로 수용할 수 있다
  - 부모 데이터와 독립적인 자식 데이터를 생성할 수 있다


- 단점

  - 데이터 정합성을 지키기 위해서는 별도의 비즈니스 로직이 필요하다.

  - 자식 데이터가 존재해도 부모 데이터가 존재하지 않을 수 있다

  - 즉, 데이터 무결성을 보장하지 않는다


**Referencce**

[[Database] 식별관계와 비 식별관계](https://deveric.tistory.com/108)